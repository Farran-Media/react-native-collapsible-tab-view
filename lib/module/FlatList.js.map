{"version":3,"names":["React","AnimatedFlatList","useAfterMountEffect","useChainCallback","useCollapsibleStyle","useScrollHandlerY","useSharedAnimatedRef","useTabNameContext","useTabsContext","useUpdateScrollViewContentSize","FlatListMemo","memo","forwardRef","props","passRef","createElement","_extends","ref","FlatListImpl","contentContainerStyle","style","onContentSizeChange","refreshControl","rest","name","setRef","contentInset","scrollHandler","enable","onLayout","_style","_contentContainerStyle","progressViewOffset","useEffect","scrollContentSizeChange","scrollContentSizeChangeHandlers","useMemo","memoRefreshControl","cloneElement","memoContentInset","top","memoContentOffset","x","y","memoContentContainerStyle","memoStyle","bouncesZoom","onScroll","scrollEventThrottle","contentOffset","automaticallyAdjustContentInsets","onMomentumScrollEnd","FlatList"],"sources":["FlatList.tsx"],"sourcesContent":["import React from 'react'\nimport { FlatList as RNFlatList, FlatListProps } from 'react-native'\n\nimport { AnimatedFlatList } from './helpers'\nimport {\n  useAfterMountEffect,\n  useChainCallback,\n  useCollapsibleStyle,\n  useScrollHandlerY,\n  useSharedAnimatedRef,\n  useTabNameContext,\n  useTabsContext,\n  useUpdateScrollViewContentSize,\n} from './hooks'\n\n/**\n * Used as a memo to prevent rerendering too often when the context changes.\n * See: https://github.com/facebook/react/issues/15156#issuecomment-474590693\n */\nconst FlatListMemo = React.memo(\n  React.forwardRef<RNFlatList, React.PropsWithChildren<FlatListProps<unknown>>>(\n    (props, passRef) => {\n      return <AnimatedFlatList ref={passRef} {...props} />\n    }\n  )\n)\n\nfunction FlatListImpl<R>(\n  {\n    contentContainerStyle,\n    style,\n    onContentSizeChange,\n    refreshControl,\n    ...rest\n  }: Omit<FlatListProps<R>, 'onScroll'>,\n  passRef: React.Ref<RNFlatList>\n): React.ReactElement {\n  const name = useTabNameContext()\n  const { setRef, contentInset } = useTabsContext()\n  const ref = useSharedAnimatedRef<RNFlatList<unknown>>(passRef)\n\n  const { scrollHandler, enable } = useScrollHandlerY(name)\n  const onLayout = useAfterMountEffect(rest.onLayout, () => {\n    'worklet'\n    // we enable the scroll event after mounting\n    // otherwise we get an `onScroll` call with the initial scroll position which can break things\n    enable(true)\n  })\n\n  const {\n    style: _style,\n    contentContainerStyle: _contentContainerStyle,\n    progressViewOffset,\n  } = useCollapsibleStyle()\n\n  React.useEffect(() => {\n    setRef(name, ref)\n  }, [name, ref, setRef])\n\n  const scrollContentSizeChange = useUpdateScrollViewContentSize({\n    name,\n  })\n\n  const scrollContentSizeChangeHandlers = useChainCallback(\n    React.useMemo(\n      () => [scrollContentSizeChange, onContentSizeChange],\n      [onContentSizeChange, scrollContentSizeChange]\n    )\n  )\n\n  const memoRefreshControl = React.useMemo(\n    () =>\n      refreshControl &&\n      React.cloneElement(refreshControl, {\n        progressViewOffset,\n        ...refreshControl.props,\n      }),\n    [progressViewOffset, refreshControl]\n  )\n\n  const memoContentInset = React.useMemo(\n    () => ({ top: contentInset }),\n    [contentInset]\n  )\n\n  const memoContentOffset = React.useMemo(\n    () => ({ x: 0, y: -contentInset }),\n    [contentInset]\n  )\n\n  const memoContentContainerStyle = React.useMemo(\n    () => [\n      _contentContainerStyle,\n      // TODO: investigate types\n      contentContainerStyle as any,\n    ],\n    [_contentContainerStyle, contentContainerStyle]\n  )\n  const memoStyle = React.useMemo(() => [_style, style], [_style, style])\n\n  return (\n    // @ts-expect-error typescript complains about `unknown` in the memo, it should be T\n    <FlatListMemo\n      {...rest}\n      onLayout={onLayout}\n      ref={ref}\n      bouncesZoom={false}\n      style={memoStyle}\n      contentContainerStyle={memoContentContainerStyle}\n      progressViewOffset={progressViewOffset}\n      onScroll={scrollHandler}\n      onContentSizeChange={scrollContentSizeChangeHandlers}\n      scrollEventThrottle={16}\n      contentInset={memoContentInset}\n      contentOffset={memoContentOffset}\n      automaticallyAdjustContentInsets={false}\n      refreshControl={memoRefreshControl}\n      // workaround for: https://github.com/software-mansion/react-native-reanimated/issues/2735\n      onMomentumScrollEnd={() => {}}\n    />\n  )\n}\n\n/**\n * Use like a regular FlatList.\n */\nexport const FlatList = React.forwardRef(FlatListImpl) as <T>(\n  p: FlatListProps<T> & { ref?: React.Ref<RNFlatList<T>> }\n) => React.ReactElement\n"],"mappings":"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","ignoreList":[]}