{"version":3,"names":["React","StyleSheet","useWindowDimensions","Animated","cancelAnimation","scrollTo","useAnimatedReaction","useAnimatedRef","useAnimatedScrollHandler","useSharedValue","withTiming","Indicator","MaterialTabItem","TABBAR_HEIGHT","MaterialTabBar","tabNames","indexDecimal","scrollEnabled","indicatorStyle","index","TabItemComponent","getLabelText","name","String","toUpperCase","onTabPress","style","tabProps","contentContainerStyle","labelStyle","inactiveColor","activeColor","tabStyle","width","customWidth","keepActiveTabCentered","tabBarRef","windowWidth","isFirstRender","useRef","itemLayoutGathering","Map","tabsOffset","isScrolling","nTabs","length","itemsLayout","setItemsLayout","useState","map","_","i","tabWidth","x","useEffect","current","onTabItemLayout","useCallback","event","_event$nativeEvent","nativeEvent","layout","set","Array","from","entries","filter","tabName","includes","sort","a","b","cancelNextScrollSync","value","onScroll","contentOffset","onBeginDrag","onMomentumEnd","currentIndexToSync","targetIndexToSync","nextIndex","canSync","halfTab","offset","createElement","ScrollView","ref","horizontal","styles","contentContainer","keyboardShouldPersistTaps","bounces","alwaysBounceHorizontal","scrollsToTop","showsHorizontalScrollIndicator","automaticallyAdjustContentInsets","overScrollMode","undefined","scrollEventThrottle","_tabProps$get","key","label","get","onPress","onLayout","fadeIn","MemoizedTabBar","memo","create","flexDirection","flexWrap"],"sources":["TabBar.tsx"],"sourcesContent":["import React from 'react'\nimport {\n  StyleSheet,\n  useWindowDimensions,\n  LayoutChangeEvent,\n} from 'react-native'\nimport Animated, {\n  cancelAnimation,\n  scrollTo,\n  useAnimatedReaction,\n  useAnimatedRef,\n  useAnimatedScrollHandler,\n  useSharedValue,\n  withTiming,\n} from 'react-native-reanimated'\n\nimport { Indicator } from './Indicator'\nimport { MaterialTabItem } from './TabItem'\nimport { MaterialTabBarProps, ItemLayout } from './types'\nimport { TabName } from '../types'\n\nexport const TABBAR_HEIGHT = 48\n\n/**\n * Basic usage looks like this:\n *\n * ```tsx\n * <Tabs.Container\n *   ...\n *   TabBarComponent={(props) => (\n *     <MaterialTabBar\n *       {...props}\n *       activeColor=\"red\"\n *       inactiveColor=\"yellow\"\n *       inactiveOpacity={1}\n *       labelStyle={{ fontSize: 14 }}\n *     />\n *   )}\n * >\n *   {...}\n * </Tabs.Container>\n * ```\n */\nconst MaterialTabBar = <T extends TabName = TabName>({\n  tabNames,\n  indexDecimal,\n  scrollEnabled = false,\n  indicatorStyle,\n  index,\n  TabItemComponent = MaterialTabItem,\n  getLabelText = (name) => String(name).toUpperCase(),\n  onTabPress,\n  style,\n  tabProps,\n  contentContainerStyle,\n  labelStyle,\n  inactiveColor,\n  activeColor,\n  tabStyle,\n  width: customWidth,\n  keepActiveTabCentered,\n}: MaterialTabBarProps<T>): React.ReactElement => {\n  const tabBarRef = useAnimatedRef<Animated.ScrollView>()\n  const windowWidth = useWindowDimensions().width\n  const width = customWidth ?? windowWidth\n  const isFirstRender = React.useRef(true)\n  const itemLayoutGathering = React.useRef(new Map<T, ItemLayout>())\n\n  const tabsOffset = useSharedValue(0)\n  const isScrolling = useSharedValue(false)\n\n  const nTabs = tabNames.length\n\n  const [itemsLayout, setItemsLayout] = React.useState<ItemLayout[]>(\n    scrollEnabled\n      ? []\n      : tabNames.map((_, i) => {\n          const tabWidth = width / nTabs\n          return { width: tabWidth, x: i * tabWidth }\n        })\n  )\n\n  React.useEffect(() => {\n    if (isFirstRender.current) {\n      isFirstRender.current = false\n    } else if (!scrollEnabled) {\n      // update items width on window resizing\n      const tabWidth = width / nTabs\n      setItemsLayout(\n        tabNames.map((_, i) => {\n          return { width: tabWidth, x: i * tabWidth }\n        })\n      )\n    }\n  }, [scrollEnabled, nTabs, tabNames, width])\n\n  const onTabItemLayout = React.useCallback(\n    (event: LayoutChangeEvent, name: T) => {\n      if (scrollEnabled) {\n        if (!event.nativeEvent?.layout) return\n        const { width, x } = event.nativeEvent.layout\n\n        itemLayoutGathering.current.set(name, {\n          width,\n          x,\n        })\n\n        // pick out the layouts for the tabs we know about (in case they changed dynamically)\n        const layout = Array.from(itemLayoutGathering.current.entries())\n          .filter(([tabName]) => tabNames.includes(tabName))\n          .map(([, layout]) => layout)\n          .sort((a, b) => a.x - b.x)\n\n        if (layout.length === tabNames.length) {\n          setItemsLayout(layout)\n        }\n      }\n    },\n    [scrollEnabled, tabNames]\n  )\n\n  const cancelNextScrollSync = useSharedValue(index.value)\n\n  const onScroll = useAnimatedScrollHandler(\n    {\n      onScroll: (event) => {\n        tabsOffset.value = event.contentOffset.x\n      },\n      onBeginDrag: () => {\n        isScrolling.value = true\n        cancelNextScrollSync.value = index.value\n      },\n      onMomentumEnd: () => {\n        isScrolling.value = false\n      },\n    },\n    []\n  )\n\n  const currentIndexToSync = useSharedValue(index.value)\n  const targetIndexToSync = useSharedValue(index.value)\n\n  useAnimatedReaction(\n    () => {\n      return index.value\n    },\n    (nextIndex) => {\n      if (scrollEnabled) {\n        cancelAnimation(currentIndexToSync)\n        targetIndexToSync.value = nextIndex\n        currentIndexToSync.value = withTiming(nextIndex)\n      }\n    },\n    [scrollEnabled]\n  )\n\n  useAnimatedReaction(\n    () => {\n      return currentIndexToSync.value === targetIndexToSync.value\n    },\n    (canSync) => {\n      if (\n        canSync &&\n        scrollEnabled &&\n        itemsLayout.length === nTabs &&\n        itemsLayout[index.value]\n      ) {\n        const halfTab = itemsLayout[index.value].width / 2\n        const offset = itemsLayout[index.value].x\n        if (\n          keepActiveTabCentered ||\n          offset < tabsOffset.value ||\n          offset > tabsOffset.value + width - 2 * halfTab\n        ) {\n          scrollTo(tabBarRef, offset - width / 2 + halfTab, 0, true)\n        }\n      }\n    },\n    [scrollEnabled, itemsLayout, nTabs]\n  )\n  return (\n    <Animated.ScrollView\n      ref={tabBarRef}\n      horizontal\n      style={style}\n      contentContainerStyle={[\n        styles.contentContainer,\n        !scrollEnabled && { width },\n        contentContainerStyle,\n      ]}\n      keyboardShouldPersistTaps=\"handled\"\n      bounces={false}\n      alwaysBounceHorizontal={false}\n      scrollsToTop={false}\n      showsHorizontalScrollIndicator={false}\n      automaticallyAdjustContentInsets={false}\n      overScrollMode=\"never\"\n      scrollEnabled={scrollEnabled}\n      onScroll={scrollEnabled ? onScroll : undefined}\n      scrollEventThrottle={16}\n    >\n      {tabNames.map((name, i) => {\n        return (\n          <TabItemComponent\n            key={name}\n            index={i}\n            name={name}\n            label={tabProps.get(name)?.label || getLabelText(name)}\n            onPress={onTabPress}\n            onLayout={\n              scrollEnabled\n                ? (event) => onTabItemLayout(event, name)\n                : undefined\n            }\n            scrollEnabled={scrollEnabled}\n            indexDecimal={indexDecimal}\n            labelStyle={labelStyle}\n            activeColor={activeColor}\n            inactiveColor={inactiveColor}\n            style={tabStyle}\n          />\n        )\n      })}\n      {itemsLayout.length === nTabs && (\n        <Indicator\n          indexDecimal={indexDecimal}\n          itemsLayout={itemsLayout}\n          fadeIn={scrollEnabled}\n          style={indicatorStyle}\n        />\n      )}\n    </Animated.ScrollView>\n  )\n}\n\nconst MemoizedTabBar = React.memo(MaterialTabBar)\n\nexport { MemoizedTabBar as MaterialTabBar }\n\nconst styles = StyleSheet.create({\n  contentContainer: {\n    flexDirection: 'row',\n    flexWrap: 'nowrap',\n  },\n})\n"],"mappings":"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","ignoreList":[]}