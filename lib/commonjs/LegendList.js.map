{"version":3,"names":["_react","_interopRequireDefault","require","_reactNativeReanimated","_hooks","e","__esModule","default","_extends","Object","assign","bind","n","arguments","length","t","r","hasOwnProperty","call","apply","AnimatedLegendList","ensureLegendList","legendListModule","Animated","createAnimatedComponent","LegendList","console","error","LegendListMemo","React","memo","forwardRef","props","passRef","createElement","ref","Fragment","LegendListImpl","contentContainerStyle","style","onContentSizeChange","refreshControl","rest","name","useTabNameContext","setRef","useTabsContext","useSharedAnimatedRef","scrollHandler","enable","useScrollHandlerY","onLayout","useAfterMountEffect","_style","_contentContainerStyle","progressViewOffset","useCollapsibleStyle","useEffect","scrollContentSizeChange","useUpdateScrollViewContentSize","scrollContentSizeChangeHandlers","useChainCallback","useMemo","memoRefreshControl","cloneElement","memoContentContainerStyle","memoStyle","bouncesZoom","onScroll","scrollEventThrottle","automaticallyAdjustContentInsets","onMomentumScrollEnd","exports"],"sources":["LegendList.tsx"],"sourcesContent":["import type { LegendListProps as LLProps } from '@legendapp/list'\nimport React from 'react'\nimport Animated from 'react-native-reanimated'\n\nimport {\n  useAfterMountEffect,\n  useChainCallback,\n  useCollapsibleStyle,\n  useScrollHandlerY,\n  useSharedAnimatedRef,\n  useTabNameContext,\n  useTabsContext,\n  useUpdateScrollViewContentSize,\n} from './hooks'\n\nlet AnimatedLegendList: React.ComponentClass<any> | null = null\n\nconst ensureLegendList = () => {\n  if (AnimatedLegendList) {\n    return\n  }\n\n  try {\n    const legendListModule = require('@legendapp/list')\n    AnimatedLegendList = Animated.createAnimatedComponent(\n      legendListModule.LegendList\n    ) as unknown as React.ComponentClass<any>\n  } catch {\n    console.error(\n      'The optional dependency @legendapp/list is not installed. Please install it to use the LegendList component.'\n    )\n  }\n}\n\n/**\n * Used as a memo to prevent rerendering too often when the context changes.\n * See: https://github.com/facebook/react/issues/15156#issuecomment-474590693\n */\nconst LegendListMemo = React.memo(\n  React.forwardRef<any, React.PropsWithChildren<any>>((props, passRef) => {\n    ensureLegendList()\n    return AnimatedLegendList ? (\n      <AnimatedLegendList ref={passRef} {...props} />\n    ) : (\n      <></>\n    )\n  })\n)\n\nfunction LegendListImpl<R>(\n  {\n    contentContainerStyle,\n    style,\n    onContentSizeChange,\n    refreshControl,\n    ...rest\n  }: Omit<LLProps<R>, 'onScroll'>,\n  passRef: React.Ref<any>\n): React.ReactElement {\n  const name = useTabNameContext()\n  const { setRef } = useTabsContext()\n  const ref = useSharedAnimatedRef<any>(passRef)\n\n  const { scrollHandler, enable } = useScrollHandlerY(name)\n  const onLayout = useAfterMountEffect(rest.onLayout, () => {\n    'worklet'\n    // we enable the scroll event after mounting\n    // otherwise we get an `onScroll` call with the initial scroll position which can break things\n    enable(true)\n  })\n\n  const {\n    style: _style,\n    contentContainerStyle: _contentContainerStyle,\n    progressViewOffset,\n  } = useCollapsibleStyle()\n\n  React.useEffect(() => {\n    setRef(name, ref)\n  }, [name, ref, setRef])\n\n  const scrollContentSizeChange = useUpdateScrollViewContentSize({\n    name,\n  })\n\n  const scrollContentSizeChangeHandlers = useChainCallback(\n    React.useMemo(\n      () => [scrollContentSizeChange, onContentSizeChange],\n      [onContentSizeChange, scrollContentSizeChange]\n    )\n  )\n\n  const memoRefreshControl = React.useMemo(\n    () =>\n      refreshControl &&\n      React.cloneElement(refreshControl, {\n        progressViewOffset,\n        ...refreshControl.props,\n      }),\n    [progressViewOffset, refreshControl]\n  )\n\n  const memoContentContainerStyle = React.useMemo(\n    () => ({\n      ..._contentContainerStyle,\n      ...(contentContainerStyle as object),\n    }),\n    [_contentContainerStyle, contentContainerStyle]\n  )\n  const memoStyle = React.useMemo(() => [_style, style], [_style, style])\n\n  return (\n    <LegendListMemo\n      {...rest}\n      onLayout={onLayout}\n      ref={ref}\n      bouncesZoom={false}\n      style={memoStyle}\n      contentContainerStyle={memoContentContainerStyle}\n      progressViewOffset={progressViewOffset}\n      onScroll={scrollHandler}\n      onContentSizeChange={scrollContentSizeChangeHandlers}\n      scrollEventThrottle={16}\n      automaticallyAdjustContentInsets={false}\n      refreshControl={memoRefreshControl}\n      // workaround for: https://github.com/software-mansion/react-native-reanimated/issues/2735\n      onMomentumScrollEnd={() => {}}\n    />\n  )\n}\n\n/**\n * Use like a regular LegendList from @legendapp/list.\n * Note: Requires allowHeaderOverscroll on the Tabs.Container for iOS.\n */\nexport const LegendList = React.forwardRef(LegendListImpl) as <T>(\n  p: Omit<LLProps<T>, 'onScroll'> & { ref?: React.Ref<any> }\n) => React.ReactElement\n"],"mappings":"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","ignoreList":[]}