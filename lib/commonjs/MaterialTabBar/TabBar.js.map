{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_reactNativeReanimated","_interopRequireWildcard","_Indicator","_TabItem","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","TABBAR_HEIGHT","exports","MaterialTabBar","tabNames","indexDecimal","scrollEnabled","indicatorStyle","index","TabItemComponent","MaterialTabItem","getLabelText","name","String","toUpperCase","onTabPress","style","tabProps","contentContainerStyle","labelStyle","inactiveColor","activeColor","tabStyle","width","customWidth","keepActiveTabCentered","tabBarRef","useAnimatedRef","windowWidth","useWindowDimensions","isFirstRender","React","useRef","itemLayoutGathering","Map","tabsOffset","useSharedValue","isScrolling","nTabs","length","itemsLayout","setItemsLayout","useState","map","_","tabWidth","x","useEffect","current","onTabItemLayout","useCallback","event","_event$nativeEvent","nativeEvent","layout","Array","from","entries","filter","tabName","includes","sort","a","b","cancelNextScrollSync","value","onScroll","useAnimatedScrollHandler","contentOffset","onBeginDrag","onMomentumEnd","currentIndexToSync","targetIndexToSync","useAnimatedReaction","nextIndex","cancelAnimation","withTiming","canSync","halfTab","offset","scrollTo","createElement","ScrollView","ref","horizontal","styles","contentContainer","keyboardShouldPersistTaps","bounces","alwaysBounceHorizontal","scrollsToTop","showsHorizontalScrollIndicator","automaticallyAdjustContentInsets","overScrollMode","undefined","scrollEventThrottle","_tabProps$get","key","label","onPress","onLayout","Indicator","fadeIn","MemoizedTabBar","memo","StyleSheet","create","flexDirection","flexWrap"],"sources":["TabBar.tsx"],"sourcesContent":["import React from 'react'\nimport {\n  StyleSheet,\n  useWindowDimensions,\n  LayoutChangeEvent,\n} from 'react-native'\nimport Animated, {\n  cancelAnimation,\n  scrollTo,\n  useAnimatedReaction,\n  useAnimatedRef,\n  useAnimatedScrollHandler,\n  useSharedValue,\n  withTiming,\n} from 'react-native-reanimated'\n\nimport { Indicator } from './Indicator'\nimport { MaterialTabItem } from './TabItem'\nimport { MaterialTabBarProps, ItemLayout } from './types'\nimport { TabName } from '../types'\n\nexport const TABBAR_HEIGHT = 48\n\n/**\n * Basic usage looks like this:\n *\n * ```tsx\n * <Tabs.Container\n *   ...\n *   TabBarComponent={(props) => (\n *     <MaterialTabBar\n *       {...props}\n *       activeColor=\"red\"\n *       inactiveColor=\"yellow\"\n *       inactiveOpacity={1}\n *       labelStyle={{ fontSize: 14 }}\n *     />\n *   )}\n * >\n *   {...}\n * </Tabs.Container>\n * ```\n */\nconst MaterialTabBar = <T extends TabName = TabName>({\n  tabNames,\n  indexDecimal,\n  scrollEnabled = false,\n  indicatorStyle,\n  index,\n  TabItemComponent = MaterialTabItem,\n  getLabelText = (name) => String(name).toUpperCase(),\n  onTabPress,\n  style,\n  tabProps,\n  contentContainerStyle,\n  labelStyle,\n  inactiveColor,\n  activeColor,\n  tabStyle,\n  width: customWidth,\n  keepActiveTabCentered,\n}: MaterialTabBarProps<T>): React.ReactElement => {\n  const tabBarRef = useAnimatedRef<Animated.ScrollView>()\n  const windowWidth = useWindowDimensions().width\n  const width = customWidth ?? windowWidth\n  const isFirstRender = React.useRef(true)\n  const itemLayoutGathering = React.useRef(new Map<T, ItemLayout>())\n\n  const tabsOffset = useSharedValue(0)\n  const isScrolling = useSharedValue(false)\n\n  const nTabs = tabNames.length\n\n  const [itemsLayout, setItemsLayout] = React.useState<ItemLayout[]>(\n    scrollEnabled\n      ? []\n      : tabNames.map((_, i) => {\n          const tabWidth = width / nTabs\n          return { width: tabWidth, x: i * tabWidth }\n        })\n  )\n\n  React.useEffect(() => {\n    if (isFirstRender.current) {\n      isFirstRender.current = false\n    } else if (!scrollEnabled) {\n      // update items width on window resizing\n      const tabWidth = width / nTabs\n      setItemsLayout(\n        tabNames.map((_, i) => {\n          return { width: tabWidth, x: i * tabWidth }\n        })\n      )\n    }\n  }, [scrollEnabled, nTabs, tabNames, width])\n\n  const onTabItemLayout = React.useCallback(\n    (event: LayoutChangeEvent, name: T) => {\n      if (scrollEnabled) {\n        if (!event.nativeEvent?.layout) return\n        const { width, x } = event.nativeEvent.layout\n\n        itemLayoutGathering.current.set(name, {\n          width,\n          x,\n        })\n\n        // pick out the layouts for the tabs we know about (in case they changed dynamically)\n        const layout = Array.from(itemLayoutGathering.current.entries())\n          .filter(([tabName]) => tabNames.includes(tabName))\n          .map(([, layout]) => layout)\n          .sort((a, b) => a.x - b.x)\n\n        if (layout.length === tabNames.length) {\n          setItemsLayout(layout)\n        }\n      }\n    },\n    [scrollEnabled, tabNames]\n  )\n\n  const cancelNextScrollSync = useSharedValue(index.value)\n\n  const onScroll = useAnimatedScrollHandler(\n    {\n      onScroll: (event) => {\n        tabsOffset.value = event.contentOffset.x\n      },\n      onBeginDrag: () => {\n        isScrolling.value = true\n        cancelNextScrollSync.value = index.value\n      },\n      onMomentumEnd: () => {\n        isScrolling.value = false\n      },\n    },\n    []\n  )\n\n  const currentIndexToSync = useSharedValue(index.value)\n  const targetIndexToSync = useSharedValue(index.value)\n\n  useAnimatedReaction(\n    () => {\n      return index.value\n    },\n    (nextIndex) => {\n      if (scrollEnabled) {\n        cancelAnimation(currentIndexToSync)\n        targetIndexToSync.value = nextIndex\n        currentIndexToSync.value = withTiming(nextIndex)\n      }\n    },\n    [scrollEnabled]\n  )\n\n  useAnimatedReaction(\n    () => {\n      return currentIndexToSync.value === targetIndexToSync.value\n    },\n    (canSync) => {\n      if (\n        canSync &&\n        scrollEnabled &&\n        itemsLayout.length === nTabs &&\n        itemsLayout[index.value]\n      ) {\n        const halfTab = itemsLayout[index.value].width / 2\n        const offset = itemsLayout[index.value].x\n        if (\n          keepActiveTabCentered ||\n          offset < tabsOffset.value ||\n          offset > tabsOffset.value + width - 2 * halfTab\n        ) {\n          scrollTo(tabBarRef, offset - width / 2 + halfTab, 0, true)\n        }\n      }\n    },\n    [scrollEnabled, itemsLayout, nTabs]\n  )\n  return (\n    <Animated.ScrollView\n      ref={tabBarRef}\n      horizontal\n      style={style}\n      contentContainerStyle={[\n        styles.contentContainer,\n        !scrollEnabled && { width },\n        contentContainerStyle,\n      ]}\n      keyboardShouldPersistTaps=\"handled\"\n      bounces={false}\n      alwaysBounceHorizontal={false}\n      scrollsToTop={false}\n      showsHorizontalScrollIndicator={false}\n      automaticallyAdjustContentInsets={false}\n      overScrollMode=\"never\"\n      scrollEnabled={scrollEnabled}\n      onScroll={scrollEnabled ? onScroll : undefined}\n      scrollEventThrottle={16}\n    >\n      {tabNames.map((name, i) => {\n        return (\n          <TabItemComponent\n            key={name}\n            index={i}\n            name={name}\n            label={tabProps.get(name)?.label || getLabelText(name)}\n            onPress={onTabPress}\n            onLayout={\n              scrollEnabled\n                ? (event) => onTabItemLayout(event, name)\n                : undefined\n            }\n            scrollEnabled={scrollEnabled}\n            indexDecimal={indexDecimal}\n            labelStyle={labelStyle}\n            activeColor={activeColor}\n            inactiveColor={inactiveColor}\n            style={tabStyle}\n          />\n        )\n      })}\n      {itemsLayout.length === nTabs && (\n        <Indicator\n          indexDecimal={indexDecimal}\n          itemsLayout={itemsLayout}\n          fadeIn={scrollEnabled}\n          style={indicatorStyle}\n        />\n      )}\n    </Animated.ScrollView>\n  )\n}\n\nconst MemoizedTabBar = React.memo(MaterialTabBar)\n\nexport { MemoizedTabBar as MaterialTabBar }\n\nconst styles = StyleSheet.create({\n  contentContainer: {\n    flexDirection: 'row',\n    flexWrap: 'nowrap',\n  },\n})\n"],"mappings":"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","ignoreList":[]}