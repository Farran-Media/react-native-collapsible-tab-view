{"version":3,"names":["_react","_interopRequireDefault","require","_helpers","_hooks","e","__esModule","default","_extends","Object","assign","bind","n","arguments","length","t","r","hasOwnProperty","call","apply","SectionListMemo","React","memo","forwardRef","props","passRef","createElement","AnimatedSectionList","ref","SectionListImpl","contentContainerStyle","style","onContentSizeChange","refreshControl","rest","name","useTabNameContext","setRef","contentInset","useTabsContext","useSharedAnimatedRef","scrollHandler","enable","useScrollHandlerY","onLayout","useAfterMountEffect","_style","_contentContainerStyle","progressViewOffset","useCollapsibleStyle","useEffect","scrollContentSizeChange","useUpdateScrollViewContentSize","scrollContentSizeChangeHandlers","useChainCallback","useMemo","memoRefreshControl","cloneElement","memoContentInset","top","memoContentOffset","x","y","memoContentContainerStyle","memoStyle","bouncesZoom","onScroll","scrollEventThrottle","contentOffset","automaticallyAdjustContentInsets","onMomentumScrollEnd","SectionList","exports"],"sources":["SectionList.tsx"],"sourcesContent":["import React from 'react'\nimport { SectionList as RNSectionList, SectionListProps } from 'react-native'\n\nimport { AnimatedSectionList } from './helpers'\nimport {\n  useAfterMountEffect,\n  useChainCallback,\n  useCollapsibleStyle,\n  useScrollHandlerY,\n  useSharedAnimatedRef,\n  useTabNameContext,\n  useTabsContext,\n  useUpdateScrollViewContentSize,\n} from './hooks'\n\n/**\n * Used as a memo to prevent rerendering too often when the context changes.\n * See: https://github.com/facebook/react/issues/15156#issuecomment-474590693\n */\nconst SectionListMemo = React.memo(\n  React.forwardRef<\n    RNSectionList,\n    React.PropsWithChildren<SectionListProps<unknown>>\n  >((props, passRef) => {\n    return (\n      <AnimatedSectionList\n        // @ts-expect-error reanimated types are broken on ref\n        ref={passRef}\n        {...props}\n      />\n    )\n  })\n)\n\nfunction SectionListImpl<R>(\n  {\n    contentContainerStyle,\n    style,\n    onContentSizeChange,\n    refreshControl,\n    ...rest\n  }: Omit<SectionListProps<R>, 'onScroll'>,\n  passRef: React.Ref<RNSectionList>\n): React.ReactElement {\n  const name = useTabNameContext()\n  const { setRef, contentInset } = useTabsContext()\n  const ref = useSharedAnimatedRef<RNSectionList<unknown>>(passRef)\n\n  const { scrollHandler, enable } = useScrollHandlerY(name)\n  const onLayout = useAfterMountEffect(rest.onLayout, () => {\n    'worklet'\n    // we enable the scroll event after mounting\n    // otherwise we get an `onScroll` call with the initial scroll position which can break things\n    enable(true)\n  })\n\n  const {\n    style: _style,\n    contentContainerStyle: _contentContainerStyle,\n    progressViewOffset,\n  } = useCollapsibleStyle()\n\n  React.useEffect(() => {\n    setRef(name, ref)\n  }, [name, ref, setRef])\n\n  const scrollContentSizeChange = useUpdateScrollViewContentSize({\n    name,\n  })\n\n  const scrollContentSizeChangeHandlers = useChainCallback(\n    React.useMemo(\n      () => [scrollContentSizeChange, onContentSizeChange],\n      [onContentSizeChange, scrollContentSizeChange]\n    )\n  )\n\n  const memoRefreshControl = React.useMemo(\n    () =>\n      refreshControl &&\n      React.cloneElement(refreshControl, {\n        progressViewOffset,\n        ...refreshControl.props,\n      }),\n    [progressViewOffset, refreshControl]\n  )\n\n  const memoContentInset = React.useMemo(\n    () => ({ top: contentInset }),\n    [contentInset]\n  )\n\n  const memoContentOffset = React.useMemo(\n    () => ({ x: 0, y: -contentInset }),\n    [contentInset]\n  )\n\n  const memoContentContainerStyle = React.useMemo(\n    () => [\n      _contentContainerStyle,\n      // TODO: investigate types\n      contentContainerStyle as any,\n    ],\n    [_contentContainerStyle, contentContainerStyle]\n  )\n  const memoStyle = React.useMemo(() => [_style, style], [_style, style])\n\n  return (\n    // @ts-expect-error typescript complains about `unknown` in the memo, it should be T\n    <SectionListMemo\n      {...rest}\n      onLayout={onLayout}\n      ref={ref}\n      bouncesZoom={false}\n      style={memoStyle}\n      contentContainerStyle={memoContentContainerStyle}\n      progressViewOffset={progressViewOffset}\n      onScroll={scrollHandler}\n      onContentSizeChange={scrollContentSizeChangeHandlers}\n      scrollEventThrottle={16}\n      contentInset={memoContentInset}\n      contentOffset={memoContentOffset}\n      automaticallyAdjustContentInsets={false}\n      refreshControl={memoRefreshControl}\n      // workaround for: https://github.com/software-mansion/react-native-reanimated/issues/2735\n      onMomentumScrollEnd={() => {}}\n    />\n  )\n}\n\n/**\n * Use like a regular SectionList.\n */\nexport const SectionList = React.forwardRef(SectionListImpl) as <T>(\n  p: SectionListProps<T> & { ref?: React.Ref<RNSectionList<T>> }\n) => React.ReactElement\n"],"mappings":"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","ignoreList":[]}